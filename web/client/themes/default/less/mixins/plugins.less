//
// Copyright 2021, GeoSolutions Sas.
// All rights reserved.
//
// This source code is licensed under the BSD-style license found in the
// LICENSE file in the root directory of this source tree.
//

// mapstore plugins theme mixins with css variables used by write .write-ms-theme function

.mapstore-circle-loader-with-css-variables(
    @border: 1.1em;
    @size: 10em;
    @color: @ms-theme-vars[loader-color];
    @color-fade: @ms-theme-vars[loader-fade-color];
) {
    text-indent: -9999em;
    border-width: @border;
    border-style: solid;
    .border-top-color-var(@color-fade);
    .border-right-color-var(@color-fade);
    .border-bottom-color-var(@color-fade);
    .border-left-color-var(@color);
    -webkit-transform: translateZ(0);
    -ms-transform: translateZ(0);
    transform: translateZ(0);
    -webkit-animation: mapstore-circle-load8 1.1s infinite linear;
    animation: mapstore-circle-load8 1.1s infinite linear;
    border-radius: 50%;
    width: @size;
    height: @size;
    .mapstore-circle-loader:after {
        border-radius: 50%;
        width: @size;
        height: @size;
    }
}

// ag-grid.less
.ag-grid-with-css-variables(@theme-vars) {

    .ag-fresh .ag-header,
    .ag-fresh .ag-tool-panel-container {
        .color-var(@theme-vars[primary-color]);
        .background-color-var(@theme-vars[primary-bg], true);
    }

    .ag-fresh .ag-tool-panel-container .ag-list-selection {
        .color-var(@theme-vars[body-color]);
    }

    .ag-fresh .ag-paging-button {
        .color-var(@theme-vars[primary-bg]);
        .background-color-var(@theme-vars[body-bg], true);
        .border-color-var(@theme-vars[primary-bg], true);
    }

    .ag-fresh .ag-paging-page-summary-panel {
        .color-var(@theme-vars[primary-bg]);
    }

    .ag-fresh .ag-paging-panel {
        .background-color-var(@theme-vars[body-bg]);
    }

    .ag-fresh .ag-body {
        .background-color-var(@theme-vars[body-bg], true);
    }

    .ag-fresh .ag-body .ag-row-even {
        .background-color-var(@theme-vars[body-bg], true);
    }

    .ag-fresh .ag-body .ag-row-odd {
        .background-color-var(@theme-vars[body-shade-bg], true);
    }
}

// annotations.less
.annotations-with-css-variables(@theme-vars) {
    #mapstore-annotations-panel {
        .background-color-var(@theme-vars[body-bg]);
    }
    .mapstore-annotations-info-viewer .ql-snow .ql-stroke {
        .stroke-var(@theme-vars[body-color]);
    }

    .mapstore-annotations-info-viewer .ql-snow .ql-picker {
        .color-var(@theme-vars[body-color]);
    }

    .mapstore-annotations-info-viewer-marker-selected {
        .border-color-var(@theme-vars[danger]);
    }

    .mapstore-annotations-info-viewer>.annotations-edit-error {
        .border-color-var(@theme-vars[body-border-color]);
    }

    .ql-disabled {
        .background-color-var(@theme-vars[body-shade-bg]);
    }

    .mapstore-annotations-info-viewer {
        .mapstore-annotations-info-viewer-items {
            .geometry-card {
                &.ms-selected {
                    .border-color-var(@theme-vars[focus-color]);
                }
            }
        }

        .mapstore-annotations-info-viewer-expanded {
            .border-right-color-var(@theme-vars[body-border-color]);

            .panel {
                .border-color-var(@theme-vars[body-border-color]);
            }

            .ms-dragg:first-child {
                .border-top-color-var(@theme-vars[body-border-color]);
            }

            .ms-dragg+.ms-dragg {
                .border-top-color-var(@theme-vars[body-border-color]);
            }

            .ms-dragg:last-child {
                .border-bottom-color-var(@theme-vars[body-border-color]);
            }
        }
    }

    .ms-annotations-panel {
        .ms2-border-layout-content {
            .ms-preview {
                h4 {
                    .border-bottom-color-var(@theme-vars[body-border-color]);
                }
            }
        }
    }

    .mapstore-annotations-info-viewer .container-fluid .container-fluid .row {
        .row:hover {

            input,
            select,
            .col-xs-5 span {
                .color-var(@theme-vars[primary-bg]);
            }
        }
    }

    .ms-dragg.ms-below .coordinateRow,
    .ms-dragg.ms-above .coordinateRow {
        & {
            .background-color-var(@theme-vars[body-bg]);
        }

        &:hover {

            input,
            select,
            .col-xs-5 span {
                .color-var(@theme-vars[primary-bg]);
            }
        }
    }

    .mapstore-identify-viewer {
        .mapstore-annotations-info-viewer.hover-background:hover {
            .background-color-var(@theme-vars[body-bg]);
        }

        .mapstore-annotations-info-viewer+.mapstore-annotations-info-viewer {
            .mapstore-annotations-info-viewer-buttons {
                .border-top-color-var(@theme-vars[body-border-color]);
            }
        }
    }

    .ms-over {
        .coordinateRow {
            .border-color-var(@theme-vars[primary-bg]);
        }

        &.ms-dragging {
            .coordinateRow {
                .border-color-var(@theme-vars[body-border-color]);
            }
        }
    }
}

// autocomplete.less
.autocomplete-with-css-variables(@theme-vars) {

    .autocompleteField .autocomplete-toolbar .chevron-left,
    .autocompleteField .autocomplete-toolbar .chevron-right,
    .autocompleteField .autocomplete-toolbar .rw-list-option:hover {
        .color-var(@theme-vars[primary-color]);
    }
}

// common.less
.common-with-css-variables(@theme-vars) {

    .option-icon {
        .color-var(@theme-vars[primary]);
    }

    .viewer {
        .background-color-var(@theme-vars[body-bg], true);
    }

    textarea {
        .color-var(@theme-vars[body-shade-color]);
        .background-color-var(@theme-vars[body-shade-bg]);
        .border-color-var(@theme-vars[body-border-color]);
    }

    .portal-dialog {
        .background-color-var(@theme-vars[body-bg], true);
    }

    .sidepanel-content {
        .background-color-var(@theme-vars[body-bg]);
    }

    .m-header {
        .background-color-var(@theme-vars[body-bg]);
    }

    .ms2-border-layout-content {
        .background-color-var(@theme-vars[body-bg]);
    }

    div#sync-popover.popover {
        h3 {
            .color-var(@theme-vars[primary-color]);
            .background-color-var(@theme-vars[primary-bg]);
        }
    }

    .error-container {
        .runtime-error-message {
            .color-var(@theme-vars[body-shade-color]);
            .background-color-var(@theme-vars[body-shade-bg]);

            &.inverse {
                .color-var(@theme-vars[body-shade-bg]);
                .background-color-var(@theme-vars[body-shade-color]);
            }

            .refresh-icon:hover {
                .color-var(@theme-vars[primary]);
            }
        }
    }
}

// context-creator.less
.context-creator-with-css-variables(@theme-vars) {
    .configure-plugins-step-upload {
        .dropzone {
            .color-var(@theme-vars[primary-bg]);
            .background-color-var(@theme-vars[primary-color]);
            .border-color-var(@theme-vars[body-border-color]);
        }

        .title-header {
            .color-var(@theme-vars[primary-color]);
            .background-color-var(@theme-vars[primary-bg]);
        }

        .uploading-file {
            .border-color-var(@theme-vars[body-border-color]);

            .glyphicon-ok {
                .color-var(@theme-vars[success]);
            }

            .glyphicon-remove {
                .color-var(@theme-vars[danger]);
            }
        }
    }

    .configure-plugins-step {
        .plugin-configuration-line-error {
            .background-color-var(@theme-vars[danger]);
        }

        .plugin-configuration-errorarea {
            .plugin-configuration-errorarea-header {
                .color-var(@theme-vars[warning-color]);
                .background-color-var(@theme-vars[warning-bg]);
            }

            .plugin-configuration-errormsg {
                .color-var(@theme-vars[danger-color]);
                .background-color-var(@theme-vars[danger-bg]);
            }
        }

        .configure-map-templates-transfer {

            .mapstore-side-preview {
                .configure-map-templates-preview {
                    .background-color-var(@theme-vars[body-shade-bg]);
                }

                .glyphicon {
                    .color-var(@theme-vars[body-bg]);
                }
            }
        }
    }
}

// cookie.less
.cookie-with-css-variables(@theme-vars) {

    .mapstore-cookie-panel,
    .cookie-body-container {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);
    }

    .cookie-title,
    .cookie-header {
        .color-var(@theme-vars[primary-color]);
    }
}

// geostory-navigation.less
.geostory-navigation-with-css-variables(@theme-vars) {
    .ms-geostory-navigation {
        .background-color-var(@theme-vars[body-bg]);

        .ms-geostory-navigation-bar {
            .progress-bar {
                .background-color-var(@theme-vars[body-shade-bg]);

                .progress-percent {
                    .background-color-var(@theme-vars[primary]);
                }
            }
        }

        .ms-horizontal-menu {
            .ms-menu-item {
                .active {
                    .color-var(@theme-vars[primary-color]);
                    .background-color-var(@theme-vars[primary-bg]);
                }
            }
        }
    }
}

// geostory.less
.geostory-with-css-variables(@theme-vars) {
    .ms-geostory-builder {
        .ms-geostory-builder-header {
            .border-bottom-color-var(@theme-vars[body-shade-bg]);
        }

        .msSideGrid {
            .mapstore-side-card.ms-highlight {
                .outline-color-var(@theme-vars[focus-color]);
            }

            .ms-over:not(.ms-dragging) {
                &.ms-above {
                    &>div {
                        .border-bottom-color-var(@theme-vars[primary]);
                    }
                }

                &.ms-below {
                    &>div {
                        .border-top-color-var(@theme-vars[primary]);
                    }
                }
            }
        }

        .ms-section-preview {
            .ms-section-preview-icon {
                .border-top-color-var(@theme-vars[body-shade-bg]);
            }
        }
    }

    .ms-geostory-map-editor {
        .ms-geostory-map-editor-header {
            .border-bottom-color-var(@theme-vars[body-border-color]);
        }
    }

    .ms-cascade-story {
        .background-color-var(@theme-vars[body-bg]);

        .ms-sections-container {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg]);
        }

        .ms-section {

            .ms-section-contents {
                .ms-column-contents {
                    .add-bar {
                        .color-var(@theme-vars[body-color]);
                        .background-color-var(@theme-vars[body-bg]);

                        button {
                            .color-var(@theme-vars[body-color]);
                        }
                    }
                }
            }

            .add-bar {
                .background-color-var(@theme-vars[body-bg]);
                .border-top-color-var(@theme-vars[body-shade-bg]);
                .border-right-color-var(@theme-vars[body-shade-bg]);
                .border-left-color-var(@theme-vars[body-shade-bg]);
            }
        }

        // style for active button in toolbar
        .ms-content-toolbar>.btn-group>span>.btn.active {
            .color-var(@theme-vars[success-color]);
            .background-color-var(@theme-vars[success-bg]);
        }

        .ms-content {
            &.ms-content-text {
                .ms-content-body {
                    .ms-text-editor-toolbar {
                        .color-var(@theme-vars[body-color]);
                        .background-color-var(@theme-vars[body-bg]);

                        .rdw-option-active {
                            .outline-color-var(@theme-vars[focus-color]);
                        }

                        .rdw-colorpicker-modal-style-label-active {
                            .border-bottom-color-var(@theme-vars[focus-color]);
                        }
                    }
                }
            }
        }

        .ms-media-caption {
            .border-left-color-var(@theme-vars[body-shade-bg]);
        }
    }

    .ms-expanded-media-container {
        &>*:not(button) {
            .background-color-var(@theme-vars[body-bg]);
        }
    }

    .ms-custom-theme-picker-field {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);
    }

    .ms-custom-theme-picker-popover {
        .glyphicon {
            .color-var(@theme-vars[danger]);
        }
    }

    .ms-custom-theme-picker-menuitem-header {
        .color-var(@theme-vars[body-color]);
    }

    .ms-custom-theme-picker-menuitem {
        .border-color-var(@theme-vars[body-shade-bg]);
    }
}

// help-badge
.help-badge-with-css-variables(@theme-vars) {
    #helpbadge-scaleBox {
        background-color: @theme-vars[primary-color];
        color: @theme-vars[primary-bg];
    }

    #mapstore-navbar #helpbadge-search-help {
        background-color: @theme-vars[primary-color];
        color: @theme-vars[primary-bg];
    }
}

// infobubbles.less
.infobubbles-with-css-variables(@theme-vars) {
    .mapstore-info-bubble {
        .mapstore-info-bubble-container {
            .mapstore-info-bubble-arrow-container {
                &.arrow-bottom {
                    .mapstore-info-bubble-arrow {
                        .border-top-color-var(@theme-vars[body-bg]);
                    }
                }

                &.arrow-top {
                    .mapstore-info-bubble-arrow {
                        .border-bottom-color-var(@theme-vars[body-bg]);
                    }
                }

                &.arrow-left {
                    .mapstore-info-bubble-arrow {
                        .border-right-color-var(@theme-vars[body-bg]);
                    }
                }

                &.arrow-right {
                    .mapstore-info-bubble-arrow {
                        .border-left-color-var(@theme-vars[body-bg]);
                    }
                }
            }

            .mapstore-info-bubble-default-inner {
                .border-color-var(@theme-vars[body-bg]);
                .background-color-var(@theme-vars[body-bg]);

                &.mapstore-info-bubble-default-inner-level-success {
                    .color-var(@theme-vars[success]);
                }

                &.mapstore-info-bubble-default-inner-level-danger {
                    .color-var(@theme-vars[danger]);
                }
            }
        }
    }
}


// createnewmap.less

.createnewmap-with-css-variables(@theme-vars) {
    .new-map-dialog {
        .new-map-preview {
            .background-color-var(@theme-vars[body-shade-bg]);

            .glyphicon {
                .color-var(@theme-vars[body-bg]);
            }
        }
    }
}


// dashboard.less
.dashboard-with-css-variables(@theme-vars) {
    .dashboard-editor {
        .border-color-var(@theme-vars[body-border-color]);
    }
}

// details.less
.details-with-css-variables(@theme-vars) {
    .details-panel .panel-heading {
        .color-var(@theme-vars[primary-color]);
        .background-color-var(@theme-vars[primary-bg]);
    }


    .details-panel div div div.ms2-border-layout-body {
        .background-color-var(@theme-vars[body-bg]);
    }
}

// doublecolumntransfer.less
.doublecolumntransfer-with-css-variables(@theme-vars) {
    .ms2-transfer {
        .border-color-var(@theme-vars[body-border-color]);

        .btn-group-vertical {
            .border-color-var(@theme-vars[body-border-color]);
        }
    }
}

// drawer-menu.less
.drawer-menu-with-css-variables(@theme-vars) {
    #mapstore-drawermenu {
        .navHeader {
            &>.glyphicon {
                &:hover {
                    background-color: transparent;
                    .color-var(@theme-vars[primary-bg]);
                }
            }
        }
    }

    .nav-menu {
        .background-color-var(@theme-vars[body-bg]);
    }
}

// dropzone.less

.dropzone-with-css-variables(@theme-vars) {

    .dropzone-thumbnail-container .alert,
    .dropzone-filedrop-container .alert {
        .border-color-var(@theme-vars[body-border-color]);
    }

    .dropzone-filedrop-container {
        .dropzone:hover .dropzone-filedrop-remove span {
            .color-var(@theme-vars[danger]);
        }

        .dropzone {
            .dropzone-filedrop-remove span:hover {
                .color-var(@theme-vars[danger]);
                opacity: 0.7;
            }
        }
    }

    .dropzone .dropzone-content-image-added {
        .color-var(@theme-vars[body-bg]);
        text-shadow: @ms-body-border-color 2px 2px 2px;
    }

    .dropzone:hover .dropzone-remove span {
        .color-var(@theme-vars[body-bg]);
    }

    .dropzone-remove span:hover {
        .color-var(@theme-vars[danger], true);
    }

    .ms-thumbnail {
        .border-color-var(@theme-vars[body-border-color]);

        .dropzone-remove {
            .background-color-var(@theme-vars[body-bg]);
        }

        .dropzone-remove .glyphicon {
            .color-var(@theme-vars[body-color]);

            &:hover {
                .color-var(@theme-vars[body-color]);
            }
        }

        .ms-thumbnail-dropzone-active {
            outline: 2px solid lighten(@ms-primary, 20%);
        }

        .ms-thumbnail-dropzone-reject {
            outline: 2px solid lighten(@ms-danger, 10%);
        }
    }
}

// export.less
.export-with-css-variables(@theme-vars) {
    .export-panel {
        .export-panel-formats-container {
            .btn-default.format-selected {
                .border-color-var(@theme-vars[primary-bg]);
            }
        }
    }
}

// featuregrid.less
.featuregrid-with-css-variables(@theme-vars) {
    .featuregrid-geometry-filter.filter-enabled {
        .color-var(@theme-vars[primary-bg]);
    }
}

// get-feature.less
.get-feature-with-css-variables(@theme-vars) {
    #identify-container {
        .coordinates-edit-row {
            .border-color-var(@theme-vars[body-border-color]);
        }
    }

    .ms-properties-viewer {
        thead {
            .color-var(@theme-vars[body-shade-color]);
            .background-color-var(@theme-vars[body-shade-bg]);
        }

        tr+tr {
            .border-color-var(@theme-vars[body-border-color]);
        }
    }

    .ms-template-viewer {
        &>div+div {
            .border-color-var(@theme-vars[body-border-color]);
        }
    }
}

// home.less
.home-with-css-variables(@theme-vars) {
    .page-maps {
        .ms-home-description {
            .color-var(@theme-vars[jumbotron-color]);
            .background-color-var(@theme-vars[jumbotron-bg]);

            .container {
                .background-color-var(@theme-vars[jumbotron-bg]);
            }
        }

        .navbar-home {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg]);
        }

        >.container {
            +.container {
                .border-color-var(@theme-vars[body-border-color]);
            }
        }
    }
}

// layerdownload.less
.layerdownload-with-css-variables(@theme-vars) {
    .mapstore-exportdataresults-container {
        .mapstore-exportdataresults-item {
            .border-color-var(@theme-vars[body-border-color]);

            .mapstore-exportdataresults-item-buttons {
                .mapstore-exportdataresults-item-failed.btn {
                    .color-var(@theme-vars[danger-color]);
                    .background-color-var(@theme-vars[danger-bg]);
                    .border-color-var(@theme-vars[danger-bg]);
                }
            }
        }
    }
}

// leaflet.less
.leaflet-with-css-variables(@theme-vars) {

    /* Leaflet minimap style */
    .leaflet-control-minimap {
        .border-color-var(@theme-vars[primary-bg]);
    }

    .leaflet-control-minimap a {
        .background-color-var(@theme-vars[primary-bg]);
    }

    /* scale bar */
    .leaflet-control-scale-line {
        .color-var(@theme-vars[body-color]);
        background-color: transparent;
        .border-color-var(@theme-vars[body-color]);
    }

    .leaflet-container {
        .background-color-var(@theme-vars[body-bg]);
    }

    .leaflet-control-attribution {
        .color-var(@theme-vars[body-color]);

        a {
            .color-var(@theme-vars[primary-bg]);
        }
    }

}

// loading-mask.less
.loading-with-css-variables(@theme-vars) {
    .ms2-loading-mask {
        .ms2-mask {
            .background-color-var(@theme-vars[body-bg]);
        }

        .empty-state-container {
            .color-var(@theme-vars[body-color]);
        }
    }
}

// manager.less
.manager-with-css-variables(@theme-vars) {

    .group-thumb,
    .user-thumb {
        .background-color-var(@theme-vars[body-shade-bg]);
    }

    .group-edit-dialog,
    .user-edit-dialog {
        .background-color-var(@theme-vars[body-bg]);
    }

    .user-status .glyphicon-ok-sign {
        .color-var(@theme-vars[success]);
    }

    .user-status .glyphicon-minus-sign {
        .color-var(@theme-vars[danger]);
    }

    .ms-user-details-table {
        .row {
            .border-color-var(@theme-vars[body-border-color]);
        }
    }
}


// map-editor.less
.map-editor-with-css-variables(@theme-vars) {
    .map-editor-modal {
        .ms-resizable-modal .modal-content {
            .modal-footer {
                .border-color-var(@theme-vars[body-border-color]);
            }
        }
    }
}

// map-footer.less
.map-footer-with-css-variables(@theme-vars) {
    .mapstore-map-footer {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);

        .map-footer-btn {
            span {
                .color-var(@theme-vars[primary-color]);
            }
        }

        .leaflet-control-attribution {
            background-color: transparent;
            .color-var(@theme-vars[body-color]);
        }

        .ol-attribution.ol-uncollapsible {
            background-color: transparent;
            .color-var(@theme-vars[body-color]);
        }
    }
}

// map-popup.less
.map-popup-with-css-variables(@theme-vars) {
    .ms-popup-close-button {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);
    }

    .map-popup-ol {
        >.ol-popup-content-wrapper {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg]);

            >.ol-popup-content {
                .background-color-var(@theme-vars[body-bg]);
            }
        }
    }

    .map-popup-ol:after {
        .border-top-color-var(@theme-vars[body-bg]);
    }

    .map-popup-ol:before {
        .border-top-color-var(@theme-vars[body-border-color]);
    }

    .ol-popup-closer {
        .ms-popup-close-button();
    }

    .ms-leaflet-popup {
        .leaflet-popup-content {
            .background-color-var(@theme-vars[body-bg]);
        }

        .leaflet-popup-content-wrapper,
        .leaflet-popup-tip {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg]);
        }

        a.leaflet-popup-close-button {
            .ms-popup-close-button();

            &:before {
                .color-var(@theme-vars[body-color]);
            }
        }
    }
}

// map-search-bar.less
.map-search-bar-with-css-variables(@theme-vars) {

    /* search */
    #mapstore-navbar .navbar-dx .MapSearchBar .input-group {
        .background-color-var(@theme-vars[body-bg]);
    }


    .MapSearchBar .input-group-addon {
        .background-color-var(@theme-vars[body-bg]);
    }

    .navbar-dx .MapSearchBar .input-group {
        .background-color-var(@theme-vars[body-bg]);
    }


    #mapstore-navbar .search-result-list {
        .background-color-var(@theme-vars[body-bg]);
    }

    .MapSearchBar .input-group {
        .background-color-var(@theme-vars[body-bg]);

        // search toolbar
        .search-toolbar-options {

            /*
            .dropdown-menu > .active > a,
            .dropdown-menu > .active > a .glyphicon {
                &,
                &:hover,
                &:focus {
                    color: @dropdown-link-active-color;
                    background-color: @dropdown-link-active-bg;
                }
            }*/
            .btn-group-menu-options,
            .btn-group-menu-options-format {
                [disabled] {
                    .background-color-var(@theme-vars[body-bg]);
                }

                &.btn-group {
                    .btn-danger {
                        .background-color-var(@theme-vars[body-bg]);
                        color: @ms-danger;
                    }
                }
            }
        }
    }

    .advanced-search-panel {
        .background-color-var(@theme-vars[body-bg]);

        .advanced-search-context {
            .Select {
                .Select-option.is-selected {
                    .background-color-var(@theme-vars[body-bg]);
                }
            }
        }
    }
}

.mapcatalog-with-css-variables(@theme-vars) {

    // mapcatalog.less
    .map-catalog-panel {
        .map-catalog-preview {
            .background-color-var(@theme-vars[body-shade-bg]);

            .glyphicon {
                .color-var(@theme-vars[primary-color]);
            }
        }
    }
}

.maps-properties-with-css-variables(@theme-vars) {

    // maps-properties.less
    .modal-properties-container {

        .dropzone-thumbnail-container,
        .dropzone-filedrop-container {
            .dropzone {
                .background-color-var(@theme-vars[body-bg]);
            }
        }

        .ms-section {
            &.ms-transition {
                .border-color-var(@theme-vars[body-border-color]);
            }
        }

        .ms-permissions-container {
            .ms-permission-row {
                .Select {
                    .Select-control {
                        .Select-arrow-zone {
                            .border-color-var(@theme-vars[body-border-color]);
                        }
                    }
                }
            }
        }
    }
}

// maptemplates.less

.maptemplates-with-css-variables(@theme-vars) {
    .map-templates-preview {
        .background-color-var(@theme-vars[body-bg]);

        .glyphicon {
            .color-var(@theme-vars[primary-color]);
        }
    }
}

.media-editor-with-css-variables(@theme-vars) {

    // media-editor.less
    .ms-mediaEditor {
        .ms2-border-layout-body {
            .ms-mediaSelector {
                .background-color-var(@theme-vars[body-bg]);
            }
        }
    }
}

// mouse-position.less
.mouse-position-with-css-variables(@theme-vars) {
    #mapstore-mouseposition {
        span {
            .color-var(@theme-vars[body-color]);
        }

        .mapstore-mouse-coordinates {
            h5 {
                .background-color-var(@theme-vars[body-shade-bg]);

            }
        }

        .mapstore-mouse-elevation {
            h5 {
                .background-color-var(@theme-vars[body-shade-bg]);
            }
        }

        button {
            span {
                .color-var(@theme-vars[primary-color]);
            }
        }

        .form-group {
            select {
                .background-color-var(@theme-vars[body-shade-bg]);
                .color-var(@theme-vars[body-shade-color]);
            }

            option {
                .background-color-var(@theme-vars[body-bg]);
                .color-var(@theme-vars[body-color]);
            }
        }

        .mouseposition-crs {
            .background-color-var(@theme-vars[body-shade-bg]);
            .color-var(@theme-vars[body-shade-color]);
        }
    }
}

// ol.less
.ol-with-css-variables(@theme-vars) {
    .ol-viewport {
        .background-color-var(@theme-vars[body-bg]);
    }

    .ol-custom-overviewmap button {
        .background-color-var(@theme-vars[primary-bg]);
    }

    .ol-custom-overviewmap .ol-control button:focus,
    .ol-custom-overviewmap button:hover {
        .background-color-var(@theme-vars[primary-bg]);
    }

    .ol-custom-overviewmap:not(.ol-collapsed) {
        .background-color-var(@theme-vars[primary-bg]);
    }

    .ol-attribution.ol-uncollapsible {
        .color-var(@theme-vars[body-color]);
    }

    div.ol-scale-line.ol-unselectable {
        .border-color-var(@theme-vars[body-color]);
        border-top: none;
    }

    .ol-attribution ul {
        .color-var(@theme-vars[body-color]);
    }

    div.ol-scale-line-inner {
        .color-var(@theme-vars[body-color]);
    }

    .ol-scale-line {
        background-color: transparent;
        .color-var(@theme-vars[body-color]);
    }

    .ol-viewport {
        .segment-overlay {
            background: rgba(0, 0, 0, 0.5);
            color: white;
        }

        .segment-overlay-static {
            background-color: transparent;
            color: black;
            text-shadow: -1px 0 #ffa332, 0 1px #ffa332, 1px 0 #ffa332, 0 -1px #ffa332;
        }

        .tooltip {
            background: rgba(0, 0, 0, 0.5);
            color: white;
        }

        .tooltip-static {
            background-color: #ffcc33;
            color: black;
            border: 1px solid white;
        }

        .tooltip-measure:before,
        .tooltip-static:before {
            border-top: 6px solid rgba(0, 0, 0, 0.5);
            border-right: 6px solid transparent;
            border-left: 6px solid transparent;
        }

        .tooltip-static:before {
            border-top-color: #ffcc33;
        }
    }

    .ol-rotate {
        .ol-rotate-reset {
            .color-var(@theme-vars[primary-color]);
            .background-color-var(@theme-vars[primary-bg]);
            .border-color-var(@theme-vars[body-border-color]);
        }

        .ol-rotate-reset:hover,
        .ol-rotate-reset:focus {
            .background-color-var(@theme-vars[body-shade-bg]);
        }
    }
}

// pagedselect.less
.pagedselect-with-css-variables(@theme-vars) {
    .Select {
        .paged-select-bar-container {
            .paged-select-bar {

                .prev-page-button.glyphicon,
                .next-page-button.glyphicon {
                    .color-var(@theme-vars[link-color]);
                }

                .prev-page-button.glyphicon:hover,
                .next-page-button.glyphicon:hover {
                    .color-var(@theme-vars[link-hover-color]);
                }
            }
        }
    }
}

// panel.less
.panel-with-css-variables(@theme-vars) {
    .ms-side-panel {
        .ms-header {
            .background-color-var(@theme-vars[body-bg]);

            .row {
                &:first-child {
                    .color-var(@theme-vars[body-color]);
                    .background-color-var(@theme-vars[body-bg]);

                    .col-xs-8 {
                        .color-var(@theme-vars[body-color]);
                    }
                }
            }

            &.ms-primary {
                .row {
                    &:first-child {
                        .color-var(@theme-vars[primary-color]);
                        .background-color-var(@theme-vars[primary-bg]);

                        .col-xs-8 {
                            .color-var(@theme-vars[primary-color]);
                        }
                    }
                }
            }
        }
    }
}

// print.less
.print-with-css-variables(@theme-vars) {
    #mapstore-print-panel {
        .panel-heading {
            .background-color-var(@theme-vars[body-shade-bg]);
        }

        .panel-body {
            .border-color-var(@theme-vars[primary-bg]);
        }
    }
}

// query-panel.less
.query-panel-with-css-variables(@theme-vars) {
    .mapstore-string-select {
        .m-options {
            .background-color-var(@theme-vars[body-bg]);

            ul {
                li {
                    &:hover {
                        .color-var(@theme-vars[primary-color]);
                        .background-color-var(@theme-vars[primary-bg]);
                    }
                }
            }
        }
    }

    .mapstore-query-builder {
        .background-color-var(@theme-vars[body-bg]);

        .ms2-border-layout-body {
            .background-color-var(@theme-vars[body-bg]);
        }
    }

    .mapstore-conditions-group {
        .mapstore-conditions-group {
            .border-left-color-var(@theme-vars[body-color]);
        }
    }
}

// react-data-grid.less
.react-data-grid-with-css-variables(@theme-vars) {

    .react-grid-Cell,
    .react-grid-HeaderCell,
    .react-grid-Header,
    .react-grid-Grid,
    .react-grid-Canvas {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);
        .border-color-var(@theme-vars[body-border-color]);
    }

    .react-grid-Main {
        .background-color-var(@theme-vars[body-bg]);
        .outline-color-var(@theme-vars[body-border-color]);
    }

    .react-grid-Grid {
        .border-color-var(@theme-vars[body-border-color]);
    }

    .react-grid-checkbox:checked+.react-grid-checkbox-label:before {
        .background-color-var(@theme-vars[primary-bg]);
    }

    .radio-custom+.radio-custom-label:before,
    .react-grid-checkbox+.react-grid-checkbox-label:before {
        .background-color-var(@theme-vars[body-bg]);
        .border-color-var(@theme-vars[body-border-color]);
    }

    .react-grid-Canvas,
    .react-grid-Grid {
        .background-color-var(@theme-vars[body-bg]);
    }

    .react-grid-HeaderCell {
        .background-color-var(@theme-vars[body-shade-bg]);
        .border-right-color-var(@theme-vars[body-border-color]);
        .border-bottom-color-var(@theme-vars[body-border-color]);
    }

    .react-grid-Header {
        .background-color-var(@theme-vars[body-shade-bg]);
    }

    .react-grid-Cell {
        .background-color-var(@theme-vars[body-bg]);
        .border-right-color-var(@theme-vars[body-border-color]);
        .border-bottom-color-var(@theme-vars[body-border-color]);

        &:hover {
            .color-var(@theme-vars[body-hover-color]);
            .background-color-var(@theme-vars[body-hover-bg], true);
        }

        &:focus {
            outline: 2px solid @ms-primary;
            .outline-color-var(@theme-vars[focus-color]);
        }

        &.row-selected.editing input {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg], true);
        }
    }

    .react-grid-Cell--locked:last-of-type {
        .border-right-color-var(@theme-vars[body-border-color]);
    }

    .react-grid-Row {

        &.row-selected,
        .row-selected,
        .row-selected .react-grid-Cell {
            .color-var(@theme-vars[body-hover-color], true);
            .background-color-var(@theme-vars[body-hover-bg], true);
        }

        .row-context-menu .react-grid-Cell,
        &:hover .react-grid-Cell {
            .color-var(@theme-vars[body-hover-color]);
            .background-color-var(@theme-vars[body-hover-bg], true);
        }

        .react-grid-Cell.modified,
        &.row-selected .react-grid-Cell.modified,
        &.row-selected:active .react-grid-Cell.modified,
        &:hover .react-grid-Cell.modified {
            .color-var(@theme-vars[body-shade-color], true);
            .background-color-var(@theme-vars[body-shade-bg], true);
            .border-bottom-color-var(@theme-vars[primary-bg]);
        }

        .react-grid-Cell.modified.invalid,
        .react-grid-Cell.invalid,
        &.row-selected .react-grid-Cell.invalid,
        &.row-selected .react-grid-Cell.modified.invalid {
            .color-var(@theme-vars[body-shade-color], true);
            .background-color-var(@theme-vars[body-shade-bg], true);
            border-bottom: 3px solid @ms-danger;
            .border-bottom-color-var(@theme-vars[danger]);
        }

        .react-grid-Cell.modified.invalid:after,
        .react-grid-Cell.invalid:after,
        &.row-selected .react-grid-Cell.invalid:after,
        &.row-selected .react-grid-Cell.modified.invalid:after {
            .color-var(@theme-vars[danger]);
        }
    }

    .data-grid-bottom-toolbar {
        .background-color-var(@theme-vars[body-bg]);
    }

    .feature-grid-container .ms2-border-layout-body {
        .background-color-var(@theme-vars[body-shade-bg]);
    }
}


// rulesmanager.less
.rulesmanager-with-css-variables(@theme-vars) {
    .rules-manager-modal {
        .ms-style-modal .mapstore-side-card.ms-sm.ms-selected {
            .color-var(@theme-vars[primary-color]);
            .background-color-var(@theme-vars[primary-bg]);
        }
    }

    .rules-manager {
        .react-grid-Row+div {
            border-top: 4px dashed rgb(255, 238, 0);
            .border-top-color-var(@theme-vars[warning]);
        }

        textarea {
            .background-color-var(@theme-vars[body-shade-bg]);
            .border-color-var(@theme-vars[body-border-color]);
        }

        .rulesmanager-editor {
            .border-right-color-var(@theme-vars[body-border-color]);
        }

        .ms-vertical-toolbar.rules-editor.re-toolbar {
            .border-left-color-var(@theme-vars[body-border-color]);
        }

        #rules-editor {
            .border-right-color-var(@theme-vars[body-border-color]);
        }

        .ms-circle-loader-md {
            border-top: 3.5px solid rgba(7, 138, 163, 0.2);
            border-right: 3.5px solid rgba(7, 138, 163, 0.2);
            border-bottom: 3.5px solid rgba(7, 138, 163, 0.2);
            border-left: 3.5px solid #078aa3;
        }

        .ms-header {
            .border-bottom-color-var(@theme-vars[body-border-color]);
        }


        .ms-grid-card {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg]);
        }

        .ms-row-select {
            .react-grid-Cell {
                .color-var(@theme-vars[body-shade-color]);
                .background-color-var(@theme-vars[body-shade-bg]);
            }
        }

        .ms-card-success {
            border-bottom: 4px solid @ms-success;
            .border-bottom-color-var(@theme-vars[success]);

        }

        .ms-card-danger {
            border-bottom: 4px solid @ms-danger;
            .border-bottom-color-var(@theme-vars[danger]);
        }

        .ms-allow-cell {
            .color-var(@theme-vars[danger-color]);
            .background-color-var(@theme-vars[danger-bg]);
        }

        .ms-deny-cell {
            .color-var(@theme-vars[success-color]);
            .background-color-var(@theme-vars[success-bg]);
        }

        .ms-allow-row {
            .react-grid-Cell {
                border-bottom: 2px solid @ms-success;
                .border-bottom-color-var(@theme-vars[success]);
            }
        }

        .ms-deny-row {
            .react-grid-Cell {
                border-bottom: 2px solid @ms-danger;
                .border-bottom-color-var(@theme-vars[danger]);
            }
        }

        .ms-panel-header-container {
            .nav-tabs {
                .disabled {
                    a {
                        color: fade(@ms-body-color, 20%);
                    }
                }
            }
        }
    }
}

// search-bookmark-config.less
.search-bookmark-with-css-variables(@theme-vars) {
    #bookmark-tools button {
        background-color: unset;
        .color-var(@theme-vars[primary]);

        &:hover {
            .background-color-var(@theme-vars[body-shade-bg]);
        }
    }

    .bookmark-card::-webkit-scrollbar {
        .background-color-var(@theme-vars[body-bg]);
    }

    .bookmark-card::-webkit-scrollbar-thumb {
        .background-color-var(@theme-vars[body-shade-bg]);
    }
}

// searchbar.less
.searchbar-with-css-variables(@theme-vars) {
    .maps-search .input-group-addon {
        .background-color-var(@theme-vars[body-bg]);
        border-top: 1px solid lightgrey;
        border-bottom: 1px solid lightgrey;
        .border-top-color-var(@theme-vars[body-border-color]);
        .border-bottom-color-var(@theme-vars[body-border-color]);
    }

    .search-result-list {
        .background-color-var(@theme-vars[body-bg]);
    }

    .search-result-list .search-result {
        border-bottom: 1px solid lightgray;
        .border-bottom-color-var(@theme-vars[body-border-color]);
    }

    .search-result-list .search-result:hover {
        .background-color-var(@theme-vars[body-hover-bg]);
    }
}

// select.less
.select-with-css-variables(@theme-vars) {
    .rw-widget {
        .color-var(@theme-vars[primary], true);
        .background-color-var(@theme-vars[body-bg], true);
        border: 1px solid @ms-body-border-color  !important;
        .border-color-var(@theme-vars[body-border-color], true);
    }

    .rw-list-option:hover {
        .color-var(@theme-vars[primary-color], true);
        .background-color-var(@theme-vars[primary-bg], true);
    }

    .rw-state-focus {
        .color-var(@theme-vars[primary], true);
        background-color: transparent !important;
        border: 1px solid @ms-primary  !important;
        .border-color-var(@theme-vars[focus-color], true);
    }

    .rw-i {
        .color-var(@theme-vars[primary], true);
    }

    .rw-placeholder {
        .color-var(@theme-vars[body-color], true);
        .background-color-var(@theme-vars[body-bg], true);
    }

    .rw-input {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);
    }

    .rw-filter-input {
        border: 1px solid @ms-primary  !important;
        .border-color-var(@theme-vars[primary], true);
    }

    .rw-select {
        border-left: 1px solid @ms-body-border-color  !important;
        .border-left-color-var(@theme-vars[body-border-color], true);
    }

    .rw-combo-clearable {
        .background-color-var(@theme-vars[body-bg], true);
    }

    .rw-combo-clear {
        .color-var(@theme-vars[primary], true);
    }

    .rw-combo-clearable.disabled .rw-combo-clear {
        color: fadeout(@ms-primary, 30) !important;
    }

    select.form-control {
        border: 1px solid @ms-body-border-color;
        .border-color-var(@theme-vars[body-border-color]);

        option {
            .color-var(@theme-vars[body-shade-color]);
            .background-color-var(@theme-vars[body-shade-bg]);
        }
    }

    select {
        .background-color-var(@theme-vars[body-bg]);
        border: 1px solid @ms-body-border-color;
        .border-left-color-var(@theme-vars[body-border-color]);

        option {
            .color-var(@theme-vars[body-shade-color]);
            .background-color-var(@theme-vars[body-shade-bg]);
        }
    }

    #mapstore-scalebox {
        select {
            .color-var(@theme-vars[body-shade-color]);
            .background-color-var(@theme-vars[body-shade-bg]);
        }

        option {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg]);
        }
    }
}

// service-config-editor.less
.service-config-editor-with-css-variables(@theme-vars) {
    .services-config-editor {
        .services-list {
            border: 1px solid rgba(128, 128, 128, 0.55);
            .border-color-var(@theme-vars[body-border-color]);

            .glyphicon {
                .color-var(@theme-vars[primary]);
            }
        }

        .wfs-required-props-title {
            border-bottom: 1px solid gray;
            .border-color-var(@theme-vars[body-border-color]);
        }
    }
}

// settings.less
.settings-with-css-variables(@theme-vars) {
    #mapstore-settings {
        .background-color-var(@theme-vars[body-bg], true);

        .modal-body .form-group {
            border-top: solid 1px @ms-body-border-color  !important;
            .border-color-var(@theme-vars[body-border-color], true);
        }
    }

    #search-services-config-editor {
        .background-color-var(@theme-vars[body-bg], true);
    }
}

// shapefile-upload.less
.shapefile-with-css-variables(@theme-vars) {
    #mapstore-shapefile-upload {
        .background-color-var(@theme-vars[body-bg]);
    }
}

// share.less
.share-with-css-variables(@theme-vars) {
    .share-win {
        .input-link {
            +.input-link {
                border-top: 1px solid @ms-body-border-color;
                .border-color-var(@theme-vars[body-border-color]);
            }
        }

        .mapstore-switch-panel::-webkit-scrollbar {
            .background-color-var(@theme-vars[body-bg]);
        }

        .mapstore-switch-panel::-webkit-scrollbar-thumb {
            .background-color-var(@theme-vars[body-shade-bg]);
        }
    }
}

// sidegrid.less
.sidegrid-with-css-variables(@theme-vars) {
    .msSideGrid {
        .ms-drag-over {
            border: 1px dashed @ms-primary;
            .background-color-var(@theme-vars[body-bg]);
        }
    }

    .mapstore-side-card {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);

        .mapstore-side-card-info {
            .mapstore-side-card-desc {
                border-bottom: 1px solid @ms-body-border-color;
                .border-color-var(@theme-vars[body-border-color]);
            }
        }

        &.selected {
            .color-var(@theme-vars[primary-color]);
            .background-color-var(@theme-vars[primary-bg]);

            .mapstore-side-glyph {
                .color-var(@theme-vars[primary-bg]);
                .background-color-var(@theme-vars[primary-color]);
            }

            .mapstore-side-card-tool {
                >.glyphicon {
                    .color-var(@theme-vars[primary-color]);
                }
            }
        }

        &.ms-dragging {
            border: 1px dashed @ms-body-border-color;
            .border-color-var(@theme-vars[body-border-color]);
            .background-color-var(@theme-vars[body-bg]);

            .ms-head {
                .background-color-var(@theme-vars[body-bg]);
            }
        }
    }

    .ms-square-card {
        .color-var(@theme-vars[body-color]);
        .background-color-var(@theme-vars[body-bg]);

        .ms-preview {
            border: 1px solid @ms-body-border-color;
            .border-color-var(@theme-vars[body-border-color]);
        }

        &.ms-selected {
            .color-var(@theme-vars[primary-color]);
            .background-color-var(@theme-vars[primary-bg]);
        }
    }
}

// sliders.less
.sliders-with-css-variables(@theme-vars) {
    .noUi-target {
        .background-color-var(@theme-vars[primary-bg]);

        &.noUi-horizontal {
            .noUi-base {
                .noUi-origin {
                    .background-color-var(@theme-vars[body-shade-bg]);

                    .noUi-handle {
                        border-top: 1px solid @ms-body-bg;
                        .border-color-var(@theme-vars[primary-color]);
                        .background-color-var(@theme-vars[primary-bg]);

                        &:hover {
                            .background-color-var(@theme-vars[primary-bg]);
                        }

                        &:before {
                            .color-var(@theme-vars[primary-color]);
                        }

                        .noUi-tooltip {
                            &:hover {
                                .background-color-var(@theme-vars[primary-bg]);
                            }
                        }
                    }
                }
            }
        }
    }

    .noUi-target[disabled="true"],
    .mapstore-slider.with-tooltip .noUi-target[disabled="true"] {
        &.noUi-horizontal {
            .background-color-var(@theme-vars[body-shade-bg]);

            .noUi-base {
                .noUi-origin {
                    .noUi-handle {
                        .noUi-tooltip {
                            .background-color-var(@theme-vars[body-shade-bg]);
                        }
                    }
                }
            }
        }
    }

    .mapstore-slider {
        &.with-tooltip {
            .noUi-target {
                &.noUi-horizontal {
                    .noUi-base {
                        &:after {
                            .background-color-var(@theme-vars[body-shade-bg]);
                            .border-color-var(@theme-vars[body-border-color]);
                        }

                        .noUi-origin {
                            .noUi-handle {
                                .noUi-tooltip {
                                    .color-var(@theme-vars[primary-color]);
                                    .background-color-var(@theme-vars[primary-bg]);
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}

// stepper.less
.stepper-with-css-variables(@theme-vars) {
    .ms2-stepper {
        .footer-button-toolbar-div {
            border-top: 1px solid #ddd;
            .border-color-var(@theme-vars[body-border-color]);
        }
    }
}

// swipe.less
.swipe-with-css-variables(@theme-vars) {
    .mapstore-swipe-slider {
        .background-color-var(@theme-vars[primary-bg]);

        .ms-vertical-swipe-slider-arrows {
            .color-var(@theme-vars[primary-color]);
        }

        .ms-horizontal-swipe-slider-arrows {
            background-color: transparent;
            .color-var(@theme-vars[primary-color]);
        }

        .ms-slider-arrows {
            .color-var(@theme-vars[primary-bg]);
            .background-color-var(@theme-vars[primary-color]);
            border: 1px solid @ms-primary;
            .border-color-var(@theme-vars[primary-color]);
        }
    }
}

// switch.less
.switch-with-css-variables(@theme-vars) {
    .mapstore-switch-btn {
        .m-slider {
            .background-color-var(@theme-vars[primary-bg]);

            &:before {
                .background-color-var(@theme-vars[primary-color]);
            }
        }

        input {
            &:checked {
                +.m-slider {
                    .background-color-var(@theme-vars[primary-bg]);
                }
            }

            &:disabled+.m-slider {
                .background-color-var(@theme-vars[body-shade-bg]);
            }
        }
    }
}

// switchpanel.less
.switchpanel-with-css-variables(@theme-vars) {
    .mapstore-switch-panel {
        .panel-heading {
            .color-var(@theme-vars[body-color]);
            .background-color-var(@theme-vars[body-bg]);
        }
    }
}

// tutorial.less
.tutorial-with-css-variables(@theme-vars) {

    .joyride-tooltip__button--primary {
        .background-color-var(@theme-vars[primary-bg], true);

        &:active,
        &:focus,
        &:hover {
            .background-color-var(@theme-vars[primary-bg], true);
        }
    }
}

// toc.less
.toc-with-css-variables(@theme-vars) {
    .mapstore-layers-container {
        .background-color-var(@theme-vars[body-bg]);
    }

    .mapstore-toc-head {
        .toc-inline-loader {
            .mapstore-circle-loader-with-css-variables(@icon-size-md/10, @icon-size-md, @theme-vars[loader-primary-color], @theme-vars[loader-primary-fade-color]);
        }

        .mapstore-toc-head-title-container {
            .mapstore-toc-head-title {
                .color-var(@theme-vars[body-color]);
            }
        }

        .col-xs-12 {
            .border-top-color-var(@theme-vars[body-border-color]);
        }
    }

    .layer-expanded {
        &.toc-default-layer {
            .toc-default-layer-head {
                .border-bottom-color-var(@theme-vars[body-border-color]);
            }
        }
    }

    .mapstore-toc {
        .mapstore-layers-container {
            .border-top-color-var(@theme-vars[body-border-color]);
        }
    }

    .toc-default-group {
        .background-color-var(@theme-vars[body-bg]);
        .border-bottom-color-var(@theme-vars[body-border-color]);

        .toc-default-group {
            .toc-default-group-head {
                .border-top-color-var(@theme-vars[body-border-color]);
            }
        }

        .glyphicon {
            .color-var(@theme-vars[body-color]);

            &:hover {
                .color-var(@theme-vars[body-hover-color]);
            }
        }

        .toc-default-group-head {
            .background-color-var(@theme-vars[body-bg]);

            .toc-group-title {
                &:hover {
                    .color-var(@theme-vars[body-hover-color]);
                }
            }
        }

        &.selected {
            .toc-default-group-head {
                .color-var(@theme-vars[primary-color]);
                .background-color-var(@theme-vars[primary-bg]);

                .glyphicon {
                    .color-var(@theme-vars[primary-color]);
                }

                .toc-group-title:hover {
                    .color-var(@theme-vars[primary-color]);
                }
            }
        }

        &.group-error {
            .toc-default-group-head {
                .toc-error {
                    .color-var(@theme-vars[danger]);
                }

            }

            &.selected {
                .toc-error {
                    .color-var(@theme-vars[danger]);
                }
            }
        }


        .toc-default-layer {
            .background-color-var(@theme-vars[body-bg]);

            .toc-default-layer-head {
                .color-var(@theme-vars[body-color]);
                .background-color-var(@theme-vars[body-bg]);

                .toc-title {
                    &:hover {
                        .color-var(@theme-vars[body-hover-color]);
                    }
                }

                .toc-inline-loader {
                    .mapstore-circle-loader-with-css-variables(@icon-size-md/10, @icon-size-md, @theme-vars[loader-primary-color], @theme-vars[loader-primary-fade-color]);
                }
            }

            &.layer-warning {
                .visibility-check:after {
                    .color-var(@theme-vars[danger]);
                }
            }

            .collapsible-toc {

                .row {
                    .toc-full-title {
                        .color-var(@theme-vars[body-color]);
                    }

                    .toc-collapse-desc {
                        .color-var(@theme-vars[body-color]);
                    }
                }
            }

            &.selected {
                .toc-default-layer-head {
                    .color-var(@theme-vars[primary-color]);
                    .background-color-var(@theme-vars[primary-bg]);

                    .glyphicon {
                        .color-var(@theme-vars[primary-color]);
                    }

                    .toc-title:hover {
                        .color-var(@theme-vars[primary-color]);
                    }

                    .toc-inline-loader {
                        .mapstore-circle-loader-with-css-variables(@icon-size-md/10, @icon-size-md, @theme-vars[loader-color], @theme-vars[loader-fade-color]);
                    }
                }
            }

            &.layer-error {
                .background-color-var(@theme-vars[body-shade-bg]);

                .toc-default-layer-head {
                    .background-color-var(@theme-vars[body-shade-bg]);
                }

                .glyphicon {
                    .color-var(@theme-vars[body-color]);
                }

                .toc-error {
                    .color-var(@theme-vars[danger]);
                }

                &.selected {
                    .color-var(@theme-vars[primary]);

                    .glyphicon {
                        .color-var(@theme-vars[primary]);
                    }

                    .toc-error {
                        .color-var(@theme-vars[danger]);
                    }

                    .toc-title {
                        .color-var(@theme-vars[primary]);
                    }

                    .toc-default-layer-head {
                        .border-color-var(@theme-vars[danger]);
                        .background-color-var(@theme-vars[body-shade-bg]);

                        .toc-inline-loader {
                            .mapstore-circle-loader-with-css-variables(@icon-size-md/10, @icon-size-md, @theme-vars[loader-color], @theme-vars[loader-fade-color]);
                        }
                    }
                }
            }
        }
    }

    .is-dragging.toc-default-layer,
    .is-dragging.toc-default-layer.selected {
        .background-color-var(@theme-vars[body-bg], true);
        .border-color-var(@theme-vars[primary], true);

        .toc-default-layer-head {
            .background-color-var(@theme-vars[body-bg]);
            .color-var(@theme-vars[primary]);

            .glyphicon {
                .color-var(@theme-vars[primary]);
            }

            .toc-title {
                .color-var(@theme-vars[body-color]);
            }
        }
    }

    .is-placeholder.toc-default-layer,
    .is-placeholder.toc-default-layer.selected {
        .border-color-var(@theme-vars[primary], true);
    }

    .is-dragging.toc-default-group,
    .is-dragging.toc-default-group.selected {
        .background-color-var(@theme-vars[body-bg], true);
        .border-color-var(@theme-vars[primary], true);

        .toc-default-group-head {
            .background-color-var(@theme-vars[body-bg]);
            .color-var(@theme-vars[primary]);

            .glyphicon {
                .color-var(@theme-vars[primary]);
            }

            .toc-group-title {
                .color-var(@theme-vars[body-color]);
            }
        }

    }

    .is-placeholder.toc-default-group,
    .is-placeholder.toc-default-group.selected {
        .background-color-var(@theme-vars[body-bg], true);
        .border-bottom-color-var(@theme-vars[primary], true);

        .toc-default-group-head {
            .border-color-var(@theme-vars[primary], true);
        }
    }

    .compact-legend-grid {
        .background-color-var(@theme-vars[body-bg]);
    }

    .ms-legend-action {
        .background-color-var(@theme-vars[body-bg]);

        .panel-heading {
            .panel-title {
                .row {
                    .ms-legend-header {
                        >.glyphicon {
                            .color-var(@theme-vars[primary]);
                        }
                    }
                }
            }
        }

        .panel-collapse {
            .border-top-color-var(@theme-vars[body-border-color]);
        }
    }

    .thematic_layer {
        .square-button-sm.no-border[disabled] {
            .color-var(@theme-vars[primary-bg]);
            .background-color-var(@theme-vars[primary-color]);
        }
    }

    .legend-preview {
        .background-color-var(@theme-vars[body-shade-bg]);
    }
}


// widget.less
.widget-with-css-variables(@theme-vars) {
    .widget-container {
        &.selection-active {
            .background-color-var(@theme-vars[body-shade-bg]);
        }

        .mapstore-widget-card {
            .background-color-var(@theme-vars[body-bg]);

            .mapstore-widget-header {
                .border-bottom-color-var(@theme-vars[body-border-color]);
                .color-var(@theme-vars[primary]);

                .mapstore-info-popover .glyphicon {
                    .color-var(@theme-vars[primary]);
                }

                .widget-icons {
                    .btn-group {
                        button {
                            .glyphicon.active::before {
                                .color-var(@theme-vars[primary]);
                            }

                            .glyphicon:not(.active) {
                                .background-color-var(@theme-vars[body-shade-bg]);
                            }
                        }
                    }
                }
            }

            .mapstore-widget-options {
                .color-var(@theme-vars[primary]);
            }
        }
    }

    .mapstore-widget-remove {
        .color-var(@theme-vars[primary]);
    }

    .mapstore-widget-loader {
        .border-top-color-var(@theme-vars[loader-primary-fade-color]);
        .border-right-color-var(@theme-vars[loader-primary-fade-color]);
        .border-bottom-color-var(@theme-vars[loader-primary-fade-color]);
        .border-left-color-var(@theme-vars[loader-primary-color]);
    }

    .widgets-tray {
        .background-color-var(@theme-vars[body-bg]);

        .widgets-bar {
            >span {
                .border-right-color-var(@theme-vars[body-border-color]);
            }
        }
    }

    .mapstore-chart-advance-options {
        .background-color-var(@theme-vars[body-bg]);

        .ms2-border-layout-body {
            .background-color-var(@theme-vars[body-bg]);
        }
    }

    .ms-widget-empty-message {
        .background-color-var(@theme-vars[body-bg]);
    }
}

// timeline.less
.timeline-with-css-variables(@theme-vars) {
    .timeline-plugin {
        @ms-none-transparent: --ms-none, transparent;
        @ms-none-unset: --ms-none, unset;
        /* local mixin to highlight handlers on timeline, used on active and over */
        .ms-time-color-active-with-css-variables(
            @color: @theme-vars[body-color];
            @b-top: @theme-vars[body-color];
            @b-right: @ms-none-transparent;
            @b-bottom: @theme-vars[body-color];
            @b-left: @ms-none-transparent;
            @a-color: @ms-none-unset;
        ) {
            .background-color-var(@color);
            border-left-width: 1px;
            border-left-style: solid;
            .border-left-color-var(@color);
            box-sizing: unset;
            border-right-width: 1px;
            border-right-style: solid;
            .border-right-color-var(@color);
            &:before, &::before, &:after, &::after {
                .border-top-color-var(@b-top);
                .border-right-color-var(@b-right);
                .border-bottom-color-var(@b-bottom);
                .border-left-color-var(@b-left);
                .color-var(@a-color);
            }
        }
    
        .vis-custom-time {
    
            &.currentTime, &.startPlaybackTime, &.endPlaybackTime, &.offsetTime {
                .background-color-var(@theme-vars[body-color]);
                & > div {
                    &:hover, &:active {
                        /* common style between chevron left and right */
                        &:before, &::before, &:after, &::after {
                            .color-var(@theme-vars[body-color]);
                        }
                    }
                }
            }

            &.endPlaybackTime {
                .background-color-var(@theme-vars[danger]);
                /* stop icon */
                &:after, &::after {
                    .color-var(@theme-vars[danger]);
                }
                &:hover, &:active {
                    /* mixin hightlight handler, change background and stop icon colors */
                    .ms-time-color-active-with-css-variables(
                        @theme-vars[danger];
                        @ms-none-transparent;
                        @ms-none-transparent;
                        @ms-none-transparent;
                        @ms-none-transparent;
                        @theme-vars[danger];
                    );
                }
                & > div {
                    &:active, &:hover {
                        &:before, &::before, &:after, &::after {
                            .color-var(@theme-vars[danger]);
                        }
                    }
                }
            }
    
            &.startPlaybackTime {
                .background-color-var(@theme-vars[success]);
                /* play icon */
                &:after, &::after {
                    .color-var(@theme-vars[success]);
                }
                &:hover, &:active {
                    /* mixin hightlight handler, change background and play icon colors */
                    .ms-time-color-active-with-css-variables(
                        @theme-vars[success];
                        @ms-none-transparent;
                        @ms-none-transparent;
                        @ms-none-transparent;
                        @ms-none-transparent;
                        @theme-vars[success];
                    );
                }
                & > div {
                    &:active, &:hover {
                        &:before, &::before, &:after, &::after {
                            .color-var(@theme-vars[success]);
                        }
                    }
                }
            }
    
            &.currentTime {
                .background-color-var(@theme-vars[body-color]);
                /* generate a triangle on top of the handler */
                &:before, &::before {
                    .border-top-color-var(@theme-vars[body-color]);
                }
                /* generate a triangle on bottom of the handler */
                &:after, &::after {
                    .border-bottom-color-var(@theme-vars[body-color]);
                }
    
                &:hover {
                    /* mixin hightlight handler, change background and triangles colors */
                    .ms-time-color-active-with-css-variables(
                        @theme-vars[body-color];
                        @theme-vars[body-color];
                        @ms-none-transparent;
                        @theme-vars[body-color];
                    );
                }
                &:active {
                    /* mixin hightlight handler, change background and triangles colors */
                    .ms-time-color-active-with-css-variables(
                        @theme-vars[body-color];
                        @theme-vars[body-color];
                        @ms-none-transparent;
                        @theme-vars[body-color];
                    );
                }
            }
        }
    
        &.with-time-offset {
            .vis-custom-time {
                &.currentTime {
                    /* generate a smaller tiangle on bottom of the handler */
                    &:before, &::before {
                        .border-left-color-var(@theme-vars[body-color]);
                    }
                    /* generate a smaller tiangle on top of the handler */
                    &:after, &::after {
                        .border-left-color-var(@theme-vars[body-color]);
                    }
                    &:hover, &:active {
                        /* mixin hightlight handler, change background and triangles colors */
                        .ms-time-color-active-with-css-variables(
                            @theme-vars[body-color];
                            @ms-none-transparent;
                            @ms-none-transparent;
                            @ms-none-transparent;
                            @theme-vars[body-color];
                        );
                    }
                }
    
                &.offsetTime {
                    /* generate a smaller tiangle on bottom of the handler */
                    &:before, &::before {
                        .border-right-color-var(@theme-vars[body-color]);
                    }
                    /* generate a smaller tiangle on top of the handler */
                    &:after, &::after {
                        .border-right-color-var(@theme-vars[body-color]);
                    }
    
                    &:hover, &:active {
                        /* mixin hightlight handler, change background and triangles colors */
                        .ms-time-color-active-with-css-variables(
                            @theme-vars[body-color];
                            @ms-none-transparent;
                            @theme-vars[body-color];
                            @ms-none-transparent;
                            @ms-none-transparent;
                        );
                    }
                }
            }
        }

        .timeline-plugin-toolbar {
            .background-color-var(@theme-vars[body-bg]);
            &.ms-collapsed {
                .ms-inline-datetime {
                    + .timeline-plugin-btn-group {
                        .border-top-color-var(@theme-vars[body-border-color]);
                    }
                }
            }
        }
    
        .vis-timeline {
            .background-color-var(@theme-vars[body-bg]);
            .vis-item {
                .color-var(@theme-vars[body-color]);
            }
            .vis-panel {
                .vis-time-axis {
                    .vis-grid {
                        &.vis-major, &.vis-minor {
                            .border-color-var(@theme-vars[body-border-color]);
                        }
                    }
                }
                &.vis-bottom {
                    .vis-time-axis {
                        .vis-text {
                            .color-var(@theme-vars[body-shade-color]);
                        }
                        .background-color-var(@theme-vars[body-shade-bg]);
                    }
                }
                &.vis-center {
                    .vis-group {
                        &.selected {
                            .background-color-var(@theme-vars[timeline-selected-bg]);
                        }
                        &.loading {
                            .vis-item {
                                &.vis-range {
                                    &.histogram-item {
                                        .vis-item-overflow {
                                            .vis-item-content {
                                                .histogram-box {
                                                    .border-color-var(@theme-vars[body-border-color]);
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
    
                        .vis-item {
                            &.vis-dot {
                                .border-color-var(@theme-vars[timeline-histogram-border-color]);
                            }
                            &.vis-range {
                                &.histogram-item {
                                    .vis-item-content {
                                        .background-color-var(@theme-vars[timeline-histogram-bg]);
                                        .border-color-var(@theme-vars[timeline-histogram-border-color]);
                                    }
                                    .vis-item-overflow {
                                        .vis-item-content {
                                            .histogram-box {
                                                .background-color-var(@theme-vars[timeline-histogram-bg]);
                                                .border-color-var(@theme-vars[timeline-histogram-border-color]);
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                &.vis-left {
                    .color-var(@theme-vars[body-color]);
                    .background-color-var(@theme-vars[body-bg]);
                    .vis-content {
                        .border-bottom-color-var(@theme-vars[body-border-color]);
                        .vis-label {
                            .color-var(@theme-vars[body-color]);
                            &:hover {
                                .color-var(@theme-vars[body-hover-color]);
                                .background-color-var(@theme-vars[body-hover-bg]);
                            }
                            &.selected {
                                .color-var(@theme-vars[primary-color]);
                                .background-color-var(@theme-vars[primary-bg]);
                                .vis-inner {
                                    .timeline-layer-label-container {
                                        .timeline-layer-icon {
                                            .timeline-spinner {
                                                .mapstore-circle-loader-with-css-variables(1px, 12px, @theme-vars[loader-color], @theme-vars[loader-fade-color]);
                                            }
                                        }
                                    }
                                }
                            }
                            .vis-inner {
                                .timeline-layer-label-container {
                                    .timeline-layer-icon {
                                        .border-right-color-var(@theme-vars[body-border-color]);
                                        .timeline-spinner {
                                            .mapstore-circle-loader-with-css-variables(1px, 12px, @theme-vars[loader-primary-color], @theme-vars[loader-primary-fade-color]);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        .vis-item.vis-background.ms-current-range {
            .background-color-var(@theme-vars[timeline-range-bg]);
            .border-color-var(@theme-vars[body-color]);
        }

        .vis-item.vis-background.ms-playback-range {
            .background-color-var(@theme-vars[timeline-playback-range-bg]);
        }

        /* read only section */
        &, &.with-time-offset {
            .read-only-timeline {
                .vis-custom-time {
                    &.currentTime,
                    &.offsetTime {
                        .background-color-var(@theme-vars[body-color]);
                    }
    
                    &.endPlaybackTime {
                        .background-color-var(@theme-vars[danger]);
                    }
                    &.startPlaybackTime {
                        .background-color-var(@theme-vars[success]);
                    }
                }
            }
        }
    
    }
    
    .ms-inline-datetime {
        .border-right-color-var(@theme-vars[body-border-color]);
        .background-color-var(@theme-vars[body-bg]);
    }
    
    .playback-plugin {
        .ms-playback-settings {
            .background-color-var(@theme-vars[body-bg]);
            h4 {
                .border-bottom-color-var(@theme-vars[body-border-color]);
            }
        }
    }
}

// style-editor.less
.style-editor-with-css-variables(@theme-vars) {
    .ms-style-editor-container {
        .background-color-var(@theme-vars[body-bg]);
        .ms2-mask-container   {
            .ms2-mask {
                .color-var(@theme-vars[body-color]);
                .background-color-var(@theme-vars[body-bg]);
            }
        }
    }
    
    .ms-style-editor {
        .ms-style-editor-inline-widget {
            .border-color-var(@theme-vars[body-bg]);
        }
        .ms-style-editor-error {
            .color-var(@theme-vars[danger]);
        }
        .ms-style-editor-head {
            background: #262626;
            .border-bottom-color-var(@theme-vars[body-border-color]);
            .mapstore-info-popover {
                background-color: #eee;
                .text-danger {
                    .color-var(@theme-vars[danger]);
                }
            }
        }
    }
    
    ul.CodeMirror-hints {
        background-color: @ms-body-color;
        li.CodeMirror-hint {
            color: @ms-body-bg;
            &.CodeMirror-hint-active {
                background-color: @ms-primary;
            }
        }
    }
    
    .ms-style-template-title {
        .border-top-color-var(@theme-vars[body-border-color]);
    }

    // color picker and selector
    .ms-color-picker {
        .color-var(@theme-vars[body-bg]);
        .background-color-var(@theme-vars[body-bg]);
    }
    
    .ms-color-picker-overlay {
        .ms-sketch-picker {
            .background-color-var(@theme-vars[body-bg]);
        }
        .ms-sketch-picker-arrow {
            .border-right-color-var(@theme-vars[body-bg]);
        }
    }
    
    .ms-color-selector {
        .border-color-var(@theme-vars[body-border-color]);
    }

    .ms-style-editor-switch {
        .border-bottom-color-var(@theme-vars[body-border-color]);
        .btn-group {
            .border-color-var(@theme-vars[body-border-color]);
        }
    }
    
    .ms-style-rules-editor {
        .ms-style-rule {
            &.ms-drop-target {
                .border-color-var(@theme-vars[primary]);
            }
        }

        .ms-symbolizer {
            .border-color-var(@theme-vars[body-border-color]);
        }
    }
    
    .ms-symbolizer-field {
        .ms-symbolizer-value {
            &.ms-symbolizer-value-invalid {
                .outline-color-var(@theme-vars[danger]);
            }
            &.ms-symbolizer-value-warning {
                .outline-color-var(@theme-vars[warning]);
            }
        }
    }
    
    .ms-symbolizer-field-divider {
        .border-bottom-color-var(@theme-vars[body-border-color]);
    }
    
    .ms-symbolizer {
        .background-color-var(@theme-vars[body-bg]);
    }
    
    .ms-mark-list {
        .background-color-var(@theme-vars[body-bg]);
    }

    .ms-popover-overlay {
        .ms-style-rule-scale {
            .background-color-var(@theme-vars[body-bg]);
        }
        .ms-style-rule-filter {
            .background-color-var(@theme-vars[body-bg]);
        }
    }

    .ms-classification-popover {
        .background-color-var(@theme-vars[body-bg]);
    }
}

.loaders-with-css-variables(@theme-vars) {
    .ms2-loading {
        .background-color-var(@theme-vars[primary-bg], true);
        .border-bottom-color-var(@theme-vars[primary-bg], true);
    }
    .ms2-loading .sk-circle-wrapper .sk-circle:before {
        .background-color-var(@theme-vars[primary-color], true);
    }

    .mapstore-small-size-loader {
        .mapstore-circle-loader-with-css-variables(2px, 100%, @theme-vars[loader-primary-color], @theme-vars[loader-primary-fade-color]);
    }
    .mapstore-medium-size-loader {
        .mapstore-circle-loader-with-css-variables(6px, 100%, @theme-vars[loader-primary-color], @theme-vars[loader-primary-fade-color]);
    }
    .mapstore-full-size-loader {
        .mapstore-circle-loader-with-css-variables(12px, 100%, @theme-vars[loader-primary-color], @theme-vars[loader-primary-fade-color]);
    }
    .mapstore-inline-loader {
        margin: @padding-left-square-md;
        .mapstore-circle-loader-with-css-variables(@icon-size-md/10, @icon-size-md, @theme-vars[loader-primary-color], @theme-vars[loader-primary-fade-color]);
    }
}
